(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[649],{1683:function(e,t,s){Promise.resolve().then(s.bind(s,9536))},9536:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return w}});var n=s(7437),a=s(2265),r=s(551),i=s.n(r),l=s(6013),c=s(913),d=s(3102),o=s(4693),u=s(3480);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let m=(0,u.Z)("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);var x=s(2513),f=s(4817),p=s(500);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let h=(0,u.Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),y=(0,u.Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),g=(0,u.Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);var j=s(6264),v=s(7440);let b=i()(()=>s.e(270).then(s.bind(s,7270)),{loadableGenerated:{webpack:()=>[7270]},ssr:!1,loading:()=>(0,n.jsx)("div",{className:"flex h-96 items-center justify-center bg-gray-900 rounded-lg",children:(0,n.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-gray-600 border-t-indigo-500"})})}),N='# GuardRail Policy\n# Define rules to evaluate actions\n\npackage guardrail\n\nimport future.keywords.if\nimport future.keywords.in\nimport future.keywords.contains\n\ndefault deny := []\ndefault require_approval := []\n\n# Example: Deny if amount exceeds limit\ndeny contains "Amount exceeds limit" if {\n    input.action.action_type == "WITHDRAWAL"\n    to_number(input.action.amount) > 100000\n}\n\n# Example: Require approval for large transactions\nrequire_approval contains "risk_officer" if {\n    input.action.action_type == "WITHDRAWAL"\n    to_number(input.action.amount) > 10000\n}\n';function w(){let[e,t]=(0,a.useState)([]),[s,r]=(0,a.useState)(!0),[i,u]=(0,a.useState)(""),[w,_]=(0,a.useState)(!1),[C,k]=(0,a.useState)(null),[S,P]=(0,a.useState)(N),[Z,L]=(0,a.useState)(""),[R,O]=(0,a.useState)(""),[M,A]=(0,a.useState)(!1),[D,E]=(0,a.useState)(!1),[z,I]=(0,a.useState)(null);(0,a.useEffect)(()=>{W()},[i]);let W=async()=>{r(!0);let e=await j.Z.listPolicies(1,100,!1);if(e.success&&e.data){let s=e.data.items;i&&(s=s.filter(e=>{var t;return e.name.toLowerCase().includes(i.toLowerCase())||(null===(t=e.description)||void 0===t?void 0:t.toLowerCase().includes(i.toLowerCase()))})),t(s)}r(!1)},Y=()=>{k(null),P(N),L(""),O(""),I(null),_(!0)},q=e=>{k(e),P(e.rego_source),L(e.name),O(e.description||""),I(null),_(!0)},T=async()=>{if(!Z.trim()){alert("Please enter a policy name");return}A(!0);let e=await j.Z.createPolicy({name:Z,description:R||void 0,rego_source:S});if(e.success)_(!1),W();else{var t;alert("Failed to save policy: ".concat(null===(t=e.error)||void 0===t?void 0:t.message))}A(!1)},H=async()=>{if(!C)return;E(!0);let e=await j.Z.simulatePolicy(C.id,{identity:{id:"test-user",type:"HUMAN",display_name:"Test User",credentials:[{type:"KYC_LEVEL",provider:"test",value:{level:2}}]},action:{action_type:"WITHDRAWAL",amount:"50000",asset:"USDC",target_address:"0x1234567890123456789012345678901234567890"},context:{timestamp:new Date().toISOString(),ip_address:"192.168.1.1"}});if(e.success&&e.data)I(e.data);else{var t;alert("Simulation failed: ".concat(null===(t=e.error)||void 0===t?void 0:t.message))}E(!1)},U=async e=>{(e.is_active?await j.Z.deactivatePolicy(e.id):await j.Z.activatePolicy(e.id)).success&&W()};if(w){var V,F;return(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:C?"Edit Policy":"Create Policy"}),(0,n.jsx)("p",{className:"mt-1 text-gray-500",children:"Write Rego rules to define your compliance policies"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(c.z,{variant:"outline",onClick:()=>_(!1),children:"Cancel"}),C&&(0,n.jsxs)(c.z,{variant:"outline",onClick:H,disabled:D,children:[(0,n.jsx)(m,{className:"mr-2 h-4 w-4"}),D?"Simulating...":"Simulate"]}),(0,n.jsx)(c.z,{onClick:T,disabled:M,children:M?"Saving...":"Save Policy"})]})]}),(0,n.jsx)(l.Zb,{children:(0,n.jsx)(l.aY,{className:"p-4",children:(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Policy Name"}),(0,n.jsx)(d.I,{value:Z,onChange:e=>L(e.target.value),placeholder:"e.g., withdrawal-limits"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,n.jsx)(d.I,{value:R,onChange:e=>O(e.target.value),placeholder:"e.g., Enforce withdrawal limits based on KYC tier"})]})]})})}),(0,n.jsxs)("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-3",children:[(0,n.jsx)("div",{className:"lg:col-span-2",children:(0,n.jsxs)(l.Zb,{children:[(0,n.jsx)(l.Ol,{className:"py-3 px-4 border-b",children:(0,n.jsx)(l.ll,{className:"text-sm font-medium",children:"Rego Source"})}),(0,n.jsx)(l.aY,{className:"p-0",children:(0,n.jsx)(b,{height:"500px",language:"rego",theme:"vs-dark",value:S,onChange:e=>P(e||""),options:{minimap:{enabled:!1},fontSize:14,lineNumbers:"on",scrollBeyondLastLine:!1,automaticLayout:!0}})})]})}),(0,n.jsxs)("div",{children:[(0,n.jsxs)(l.Zb,{children:[(0,n.jsx)(l.Ol,{className:"py-3 px-4 border-b",children:(0,n.jsx)(l.ll,{className:"text-sm font-medium",children:"Simulation Result"})}),(0,n.jsx)(l.aY,{className:"p-4",children:z?(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{className:"text-sm font-medium",children:"Decision:"}),(0,n.jsx)(o.C,{variant:"ALLOW"===z.decision?"success":"DENY"===z.decision?"destructive":"warning",children:z.decision})]}),(null===(V=z.reasons)||void 0===V?void 0:V.length)>0&&(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"text-sm font-medium",children:"Reasons:"}),(0,n.jsx)("ul",{className:"mt-1 list-disc pl-5 text-sm text-gray-600",children:z.reasons.map((e,t)=>(0,n.jsx)("li",{children:e},t))})]}),(null===(F=z.required_approvers)||void 0===F?void 0:F.length)>0&&(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"text-sm font-medium",children:"Required Approvers:"}),(0,n.jsx)("div",{className:"mt-1 flex flex-wrap gap-1",children:z.required_approvers.map((e,t)=>(0,n.jsx)(o.C,{variant:"outline",children:e},t))})]})]}):(0,n.jsx)("p",{className:"text-sm text-gray-500 text-center py-8",children:"Run a simulation to see results"})})]}),(0,n.jsxs)(l.Zb,{className:"mt-4",children:[(0,n.jsx)(l.Ol,{className:"py-3 px-4 border-b",children:(0,n.jsx)(l.ll,{className:"text-sm font-medium",children:"Sample Input (Read-only)"})}),(0,n.jsx)(l.aY,{className:"p-4",children:(0,n.jsx)("pre",{className:"text-xs bg-gray-50 p-3 rounded overflow-auto max-h-48",children:'{\n  "identity": {\n    "type": "HUMAN",\n    "credentials": [\n      { "type": "KYC_LEVEL", "value": { "level": 2 } }\n    ]\n  },\n  "action": {\n    "action_type": "WITHDRAWAL",\n    "amount": "50000",\n    "asset": "USDC"\n  }\n}'})})]})]})]})]})}return(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Policies"}),(0,n.jsx)("p",{className:"mt-1 text-gray-500",children:"Define and manage compliance rules with Rego"})]}),(0,n.jsxs)(c.z,{onClick:Y,children:[(0,n.jsx)(x.Z,{className:"mr-2 h-4 w-4"}),"Create Policy"]})]}),(0,n.jsx)(l.Zb,{children:(0,n.jsx)(l.aY,{className:"p-4",children:(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(f.Z,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"}),(0,n.jsx)(d.I,{placeholder:"Search policies...",value:i,onChange:e=>u(e.target.value),className:"pl-10"})]})})}),s?(0,n.jsx)("div",{className:"flex h-64 items-center justify-center",children:(0,n.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-gray-300 border-t-indigo-600"})}):0===e.length?(0,n.jsx)(l.Zb,{children:(0,n.jsxs)(l.aY,{className:"flex h-64 flex-col items-center justify-center",children:[(0,n.jsx)(p.Z,{className:"h-12 w-12 text-gray-300"}),(0,n.jsx)("p",{className:"mt-4 text-lg font-medium text-gray-900",children:"No policies found"}),(0,n.jsx)("p",{className:"mt-1 text-gray-500",children:"Create your first policy to start enforcing rules"}),(0,n.jsxs)(c.z,{className:"mt-4",onClick:Y,children:[(0,n.jsx)(x.Z,{className:"mr-2 h-4 w-4"}),"Create Policy"]})]})}):(0,n.jsx)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:e.map(e=>(0,n.jsxs)(l.Zb,{className:"overflow-hidden",children:[(0,n.jsx)(l.Ol,{className:"pb-2",children:(0,n.jsxs)("div",{className:"flex items-start justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(l.ll,{className:"text-lg",children:e.name}),e.description&&(0,n.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:e.description})]}),e.is_active?(0,n.jsx)(o.C,{variant:"success",children:"Active"}):(0,n.jsx)(o.C,{variant:"secondary",children:"Inactive"})]})}),(0,n.jsx)(l.aY,{children:(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[(0,n.jsxs)("span",{children:["Version ",e.version]}),(0,n.jsx)("span",{children:"â€¢"}),(0,n.jsx)("span",{children:(0,v.p6)(e.created_at)})]}),(0,n.jsxs)("pre",{className:"text-xs bg-gray-50 p-2 rounded max-h-24 overflow-hidden",children:[e.rego_source.slice(0,200),"..."]}),(0,n.jsxs)("div",{className:"flex items-center gap-2 pt-2 border-t",children:[(0,n.jsxs)(c.z,{variant:"ghost",size:"sm",onClick:()=>q(e),children:[(0,n.jsx)(h,{className:"mr-1 h-4 w-4"}),"View"]}),(0,n.jsx)(c.z,{variant:"ghost",size:"sm",onClick:()=>U(e),children:e.is_active?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(y,{className:"mr-1 h-4 w-4"}),"Deactivate"]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g,{className:"mr-1 h-4 w-4"}),"Activate"]})})]})]})})]},e.id))})]})}},4693:function(e,t,s){"use strict";s.d(t,{C:function(){return l}});var n=s(7437);s(2265);var a=s(3027),r=s(7440);let i=(0,a.j)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground",success:"border-transparent bg-green-100 text-green-800",warning:"border-transparent bg-yellow-100 text-yellow-800",error:"border-transparent bg-red-100 text-red-800"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:s,...a}=e;return(0,n.jsx)("div",{className:(0,r.cn)(i({variant:s}),t),...a})}},3102:function(e,t,s){"use strict";s.d(t,{I:function(){return i}});var n=s(7437),a=s(2265),r=s(7440);let i=a.forwardRef((e,t)=>{let{className:s,type:a,...i}=e;return(0,n.jsx)("input",{type:a,className:(0,r.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...i})});i.displayName="Input"},2513:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s(3480).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},4817:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s(3480).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},500:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s(3480).Z)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},551:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r}});let n=s(9920);s(7437),s(2265);let a=n._(s(148));function r(e,t){var s;let n={loading:e=>{let{error:t,isLoading:s,pastDelay:n}=e;return null}};"function"==typeof e&&(n.loader=e);let r={...n,...t};return(0,a.default)({...r,modules:null==(s=r.loadableGenerated)?void 0:s.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},912:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return a}});let n=s(5592);function a(e){let{reason:t,children:s}=e;if("undefined"==typeof window)throw new n.BailoutToCSRError(t);return s}},148:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return d}});let n=s(7437),a=s(2265),r=s(912),i=s(1481);function l(e){return{default:e&&"default"in e?e.default:e}}let c={loader:()=>Promise.resolve(l(()=>null)),loading:null,ssr:!0},d=function(e){let t={...c,...e},s=(0,a.lazy)(()=>t.loader().then(l)),d=t.loading;function o(e){let l=d?(0,n.jsx)(d,{isLoading:!0,pastDelay:!0,error:null}):null,c=t.ssr?(0,n.jsxs)(n.Fragment,{children:["undefined"==typeof window?(0,n.jsx)(i.PreloadCss,{moduleIds:t.modules}):null,(0,n.jsx)(s,{...e})]}):(0,n.jsx)(r.BailoutToCSR,{reason:"next/dynamic",children:(0,n.jsx)(s,{...e})});return(0,n.jsx)(a.Suspense,{fallback:l,children:c})}return o.displayName="LoadableComponent",o}},1481:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return a}});let n=s(7437);function a(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let{getExpectedRequestStore:a}=s(8512),r=a(),i=[];if(r.reactLoadableManifest&&t){let e=r.reactLoadableManifest;for(let s of t){if(!e[s])continue;let t=e[s].files.filter(e=>e.endsWith(".css"));i.push(...t)}}return 0===i.length?null:(0,n.jsx)(n.Fragment,{children:i.map(e=>(0,n.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:r.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}}},function(e){e.O(0,[575,333,971,23,744],function(){return e(e.s=1683)}),_N_E=e.O()}]);